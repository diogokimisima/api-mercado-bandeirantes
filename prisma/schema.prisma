generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Category {
  id           Int       @id @default(autoincrement())
  categoryName String    @unique @map("category_name") @db.VarChar(100)
  createdAt    DateTime  @default(now()) @map("created_at")
  updatedAt    DateTime  @updatedAt @map("updated_at")
  products     Product[]

  @@map("categories")
}

model Product {
  id          Int         @id @default(autoincrement())
  description String      @map("description")
  pluCode     String      @unique @map("plu_code") @db.VarChar(50)
  categoryId  Int         @map("category_id")
  createdAt   DateTime    @default(now()) @map("created_at")
  updatedAt   DateTime    @updatedAt @map("updated_at")
  imageUrl    String?     @map("image_url") @db.VarChar(255)
  orderItems  OrderItem[]
  category    Category    @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@map("products")
}

model Order {
  id               Int         @id @default(autoincrement())
  orderDate        DateTime    @map("order_date")
  creationDate     DateTime    @default(now()) @map("creation_date")
  time             DateTime    @map("time")
  productsQuantity Int         @default(0) @map("products_quantity")
  itemsQuantity    Int         @default(0) @map("items_quantity")
  createdAt        DateTime    @default(now()) @map("created_at")
  updatedAt        DateTime    @updatedAt @map("updated_at")
  orderItems       OrderItem[]

  @@map("orders")
}

model OrderItem {
  id        Int      @id @default(autoincrement())
  orderId   Int      @map("order_id")
  productId Int      @map("product_id")
  quantity  Decimal  @map("quantity") @db.Decimal(10, 2)
  unitType  UnitType @map("unit_type")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
  order     Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("order_items")
}

enum UnitType {
  KG
  BOX
  UNIT
}
